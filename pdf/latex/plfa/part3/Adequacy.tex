\hypertarget{Adequacy}{%
\chapter{Adequacy: Adequacy of denotational semantics with respect to
operational semantics}\label{Adequacy}}

\begin{fence}
\begin{code}%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{plfa.part3.Adequacy}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\end{code}
\end{fence}

\hypertarget{introduction}{%
\section{Introduction}\label{introduction}}

Having proved a preservation property in the last chapter, a natural
next step would be to prove progress. That is, to prove a property of
the form

\begin{myDisplay}
If Œ≥ ‚ä¢ M ‚Üì v, then either M is a lambda abstraction or M ‚Äî‚Üí N for some N.
\end{myDisplay}

Such a property would tell us that having a denotation implies either
reduction to normal form or divergence. This is indeed true, but we can
prove a much stronger property! In fact, having a denotation that is a
function value (not \texttt{‚ä•}) implies reduction to a lambda
abstraction.

This stronger property, reformulated a bit, is known as \emph{adequacy}.
That is, if a term \texttt{M} is denotationally equal to a lambda
abstraction, then \texttt{M} reduces to a lambda abstraction.

\begin{myDisplay}
‚Ñ∞ M ‚âÉ ‚Ñ∞ (∆õ N)  implies M ‚Äî‚Ü† ∆õ N' for some N'
\end{myDisplay}

Recall that \texttt{‚Ñ∞\ M\ ‚âÉ\ ‚Ñ∞\ (∆õ\ N)} is equivalent to saying that
\texttt{Œ≥\ ‚ä¢\ M\ ‚Üì\ (v\ ‚Ü¶\ w)} for some \texttt{v} and \texttt{w}. We
will show that \texttt{Œ≥\ ‚ä¢\ M\ ‚Üì\ (v\ ‚Ü¶\ w)} implies multi-step
reduction a lambda abstraction. The recursive structure of the
derivations for \texttt{Œ≥\ ‚ä¢\ M\ ‚Üì\ (v\ ‚Ü¶\ w)} are completely different
from the structure of multi-step reductions, so a direct proof would be
challenging. However, The structure of \texttt{Œ≥\ ‚ä¢\ M\ ‚Üì\ (v\ ‚Ü¶\ w)}
closer to that of \protect\hyperlink{BigStep}{BigStep} call-by-name
evaluation. Further, we already proved that big-step evaluation implies
multi-step reduction to a lambda (\texttt{cbn‚Üíreduce}). So we shall
prove that \texttt{Œ≥\ ‚ä¢\ M\ ‚Üì\ (v\ ‚Ü¶\ w)} implies that
\texttt{Œ≥\textquotesingle{}\ ‚ä¢\ M\ ‚áì\ c}, where \texttt{c} is a closure
(a term paired with an environment), \texttt{Œ≥\textquotesingle{}} is an
environment that maps variables to closures, and \texttt{Œ≥} and
\texttt{Œ≥\textquotesingle{}} are appropriate related. The proof will be
an induction on the derivation of \texttt{Œ≥\ ‚ä¢\ M\ ‚Üì\ v}, and to
strengthen the induction hypothesis, we will relate semantic values to
closures using a \emph{logical relation} \texttt{ùïç}.

The rest of this chapter is organized as follows.

\begin{itemize}
\item
  To make the \texttt{ùïç} relation down-closed with respect to
  \texttt{‚äë}, we must loosen the requirement that \texttt{M} result in a
  function value and instead require that \texttt{M} result in a value
  that is greater than or equal to a function value. We establish
  several properties about being ``greater than a function'\,'.
\item
  We define the logical relation \texttt{ùïç} that relates values and
  closures, and extend it to a relation on terms \texttt{ùîº} and
  environments \texttt{ùîæ}. We prove several lemmas that culminate in the
  property that if \texttt{ùïç\ v\ c} and \texttt{v‚Ä≤\ ‚äë\ v}, then
  \texttt{ùïç\ v‚Ä≤\ c}.
\item
  We prove the main lemma, that if \texttt{ùîæ\ Œ≥\ Œ≥\textquotesingle{}}
  and \texttt{Œ≥\ ‚ä¢\ M\ ‚Üì\ v}, then
  \texttt{ùîº\ v\ (clos\ M\ Œ≥\textquotesingle{})}.
\item
  We prove adequacy as a corollary to the main lemma.
\end{itemize}

\hypertarget{imports}{%
\section{Imports}\label{imports}}

\begin{fence}
\begin{code}%
\>[0]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.PropositionalEquality}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{Eq}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Eq}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}‚â°\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}‚â¢\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{trans}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong‚ÇÇ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong-app}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Product}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}√ó\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaRecord{Œ£}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{Œ£-syntax}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{‚àÉ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{‚àÉ-syntax}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{proj‚ÇÅ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{proj‚ÇÇ}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{},\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®\AgdaUnderscore{},\AgdaUnderscore{}‚ü©}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Sum}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Nullary}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{¬¨\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Nullary.Negation}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{contradiction}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Empty}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{‚ä•-elim}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{‚ä•}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaDatatype{Bot}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Unit}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Nullary}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{Dec}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}‚àò\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}%
\>[58I]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{plfa.part2.Untyped}\<%
\\
\>[.][@{}l@{}]\<[58I]%
\>[5]\AgdaKeyword{using}%
\>[60I]\AgdaSymbol{(}\AgdaDatatype{Context}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}‚ä¢\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}‚àã\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{},\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{Z}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{S\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{`\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∆õ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}¬∑\AgdaUnderscore{}}}\AgdaSymbol{;}\<%
\\
\>[60I][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaFunction{rename}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{subst}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{ext}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{exts}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}[\AgdaUnderscore{}]}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{subst-zero}\AgdaSymbol{;}\<%
\\
%
\>[12]\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}‚Äî‚Ü†\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}‚Äî‚Üí‚ü®\AgdaUnderscore{}‚ü©\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}‚àé}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}‚Äî‚Üí\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{Œæ‚ÇÅ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{Œæ‚ÇÇ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{Œ≤}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{Œ∂}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{plfa.part2.Substitution}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ids}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{sub-id}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}%
\>[88I]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{plfa.part2.BigStep}\<%
\\
\>[.][@{}l@{}]\<[88I]%
\>[5]\AgdaKeyword{using}%
\>[90I]\AgdaSymbol{(}\AgdaDatatype{Clos}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{clos}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{ClosEnv}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{‚àÖ'}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{},'\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}‚ä¢\AgdaUnderscore{}‚áì\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{‚áì-var}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{‚áì-lam}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{‚áì-app}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{‚áì-determ}\AgdaSymbol{;}\<%
\\
\>[90I][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaFunction{cbn‚Üíreduce}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}%
\>[100I]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{plfa.part3.Denotational}\<%
\\
\>[.][@{}l@{}]\<[100I]%
\>[5]\AgdaKeyword{using}%
\>[102I]\AgdaSymbol{(}\AgdaDatatype{Value}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{Env}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{`‚àÖ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}`,\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}‚Ü¶\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}‚äë\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}‚ä¢\AgdaUnderscore{}‚Üì\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{‚ä•}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{all-funs‚àà}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}‚äî\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{‚àà‚Üí‚äë}\AgdaSymbol{;}\<%
\\
\>[102I][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaInductiveConstructor{var}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{‚Ü¶-elim}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{‚Ü¶-intro}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{‚äî-intro}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{‚ä•-intro}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{sub}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{‚Ñ∞}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}‚âÉ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}iff\AgdaUnderscore{}}}\AgdaSymbol{;}\<%
\\
%
\>[12]\AgdaInductiveConstructor{‚äë-trans}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{‚äë-conj-R1}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{‚äë-conj-R2}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{‚äë-conj-L}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{‚äë-refl}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{‚äë-fun}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{‚äë-bot}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{‚äë-dist}\AgdaSymbol{;}\<%
\\
%
\>[12]\AgdaFunction{sub-inv-fun}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{plfa.part3.Soundness}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{soundness}\AgdaSymbol{)}\<%
\\
\>[0]\<%
\end{code}
\end{fence}

\hypertarget{the-property-of-being-greater-or-equal-to-a-function}{%
\section{The property of being greater or equal to a
function}\label{the-property-of-being-greater-or-equal-to-a-function}}

We define the following short-hand for saying that a value is
greater-than or equal to a function value.

\begin{fence}
\begin{code}%
\>[0]\AgdaFunction{above-fun}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Value}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\<%
\\
\>[0]\AgdaFunction{above-fun}\AgdaSpace{}%
\AgdaBound{u}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Œ£[}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaFunction{‚àà}\AgdaSpace{}%
\AgdaDatatype{Value}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaFunction{Œ£[}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaFunction{‚àà}\AgdaSpace{}%
\AgdaDatatype{Value}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚Ü¶}}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äë}}\AgdaSpace{}%
\AgdaBound{u}\<%
\end{code}
\end{fence}

If a value \texttt{u} is greater than a function, then an even greater
value \texttt{u\textquotesingle{}} is too.

\begin{fence}
\begin{code}%
\>[0]\AgdaFunction{above-fun-‚äë}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{u}\AgdaSpace{}%
\AgdaBound{u'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Value}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{‚Üí}%
\>[158I]\AgdaFunction{above-fun}\AgdaSpace{}%
\AgdaBound{u}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{u}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äë}}\AgdaSpace{}%
\AgdaBound{u'}\<%
\\
\>[.][@{}l@{}]\<[158I]%
\>[8]\AgdaComment{-------------------}\<%
\\
%
\>[6]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{above-fun}\AgdaSpace{}%
\AgdaBound{u'}\<%
\\
\>[0]\AgdaFunction{above-fun-‚äë}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{lt'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚äë-trans}\AgdaSpace{}%
\AgdaBound{lt'}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\end{code}
\end{fence}

The bottom value \texttt{‚ä•} is not greater than a function.

\begin{fence}
\begin{code}%
\>[0]\AgdaFunction{above-fun‚ä•}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬¨}}\AgdaSpace{}%
\AgdaFunction{above-fun}\AgdaSpace{}%
\AgdaInductiveConstructor{‚ä•}\<%
\\
\>[0]\AgdaFunction{above-fun‚ä•}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{sub-inv-fun}\AgdaSpace{}%
\AgdaBound{lt}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[203I]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{Œì‚äÜ‚ä•}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{lt1}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{lt2}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[.][@{}l@{}]\<[203I]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{all-funs‚àà}\AgdaSpace{}%
\AgdaBound{f}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[223I]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[.][@{}l@{}]\<[223I]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{Œì‚äÜ‚ä•}\AgdaSpace{}%
\AgdaBound{m}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{()}\<%
\end{code}
\end{fence}

If the join of two values \texttt{u} and \texttt{u\textquotesingle{}} is
greater than a function, then at least one of them is too.

\begin{fence}
\begin{code}%
\>[0]\AgdaFunction{above-fun-‚äî}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{u}\AgdaSpace{}%
\AgdaBound{u'}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[11]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{above-fun}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{u}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äî}}\AgdaSpace{}%
\AgdaBound{u'}\AgdaSymbol{)}\<%
\\
%
\>[11]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{above-fun}\AgdaSpace{}%
\AgdaBound{u}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äé}}\AgdaSpace{}%
\AgdaFunction{above-fun}\AgdaSpace{}%
\AgdaBound{u'}\<%
\\
\>[0]\AgdaFunction{above-fun-‚äî}\AgdaSymbol{\{}\AgdaBound{u}\AgdaSymbol{\}\{}\AgdaBound{u'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{v‚Ü¶w‚äëu‚äîu'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{sub-inv-fun}\AgdaSpace{}%
\AgdaBound{v‚Ü¶w‚äëu‚äîu'}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[260I]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{Œì‚äÜu‚äîu'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{lt1}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{lt2}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[.][@{}l@{}]\<[260I]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{all-funs‚àà}\AgdaSpace{}%
\AgdaBound{f}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[280I]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[.][@{}l@{}]\<[280I]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{Œì‚äÜu‚äîu'}\AgdaSpace{}%
\AgdaBound{m}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{‚àà‚Üí‚äë}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{‚àà‚Üí‚äë}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\end{code}
\end{fence}

On the other hand, if neither of \texttt{u} and
\texttt{u\textquotesingle{}} is greater than a function, then their join
is also not greater than a function.

\begin{fence}
\begin{code}%
\>[0]\AgdaFunction{not-above-fun-‚äî}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{u}\AgdaSpace{}%
\AgdaBound{u'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Value}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[15]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬¨}}\AgdaSpace{}%
\AgdaFunction{above-fun}\AgdaSpace{}%
\AgdaBound{u}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬¨}}\AgdaSpace{}%
\AgdaFunction{above-fun}\AgdaSpace{}%
\AgdaBound{u'}\<%
\\
%
\>[15]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬¨}}\AgdaSpace{}%
\AgdaFunction{above-fun}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{u}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äî}}\AgdaSpace{}%
\AgdaBound{u'}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{not-above-fun-‚äî}\AgdaSpace{}%
\AgdaBound{naf1}\AgdaSpace{}%
\AgdaBound{naf2}\AgdaSpace{}%
\AgdaBound{af12}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{above-fun-‚äî}\AgdaSpace{}%
\AgdaBound{af12}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaBound{af1}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{contradiction}\AgdaSpace{}%
\AgdaBound{af1}\AgdaSpace{}%
\AgdaBound{naf1}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaBound{af2}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{contradiction}\AgdaSpace{}%
\AgdaBound{af2}\AgdaSpace{}%
\AgdaBound{naf2}\<%
\end{code}
\end{fence}

The converse is also true. If the join of two values is not above a
function, then neither of them is individually.

\begin{fence}
\begin{code}%
\>[0]\AgdaFunction{not-above-fun-‚äî-inv}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{u}\AgdaSpace{}%
\AgdaBound{u'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Value}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬¨}}\AgdaSpace{}%
\AgdaFunction{above-fun}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{u}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äî}}\AgdaSpace{}%
\AgdaBound{u'}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬¨}}\AgdaSpace{}%
\AgdaFunction{above-fun}\AgdaSpace{}%
\AgdaBound{u}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{√ó}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬¨}}\AgdaSpace{}%
\AgdaFunction{above-fun}\AgdaSpace{}%
\AgdaBound{u'}\<%
\\
\>[0]\AgdaFunction{not-above-fun-‚äî-inv}\AgdaSpace{}%
\AgdaBound{af}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaFunction{f}\AgdaSpace{}%
\AgdaBound{af}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{g}\AgdaSpace{}%
\AgdaBound{af}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaFunction{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{u}\AgdaSpace{}%
\AgdaBound{u'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Value}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬¨}}\AgdaSpace{}%
\AgdaFunction{above-fun}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{u}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äî}}\AgdaSpace{}%
\AgdaBound{u'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬¨}}\AgdaSpace{}%
\AgdaFunction{above-fun}\AgdaSpace{}%
\AgdaBound{u}\<%
\\
%
\>[4]\AgdaFunction{f}\AgdaSymbol{\{}\AgdaBound{u}\AgdaSymbol{\}\{}\AgdaBound{u'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{af12}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaFunction{contradiction}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚äë-conj-R1}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaBound{af12}\<%
\\
%
\>[4]\AgdaFunction{g}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{u}\AgdaSpace{}%
\AgdaBound{u'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Value}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬¨}}\AgdaSpace{}%
\AgdaFunction{above-fun}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{u}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äî}}\AgdaSpace{}%
\AgdaBound{u'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬¨}}\AgdaSpace{}%
\AgdaFunction{above-fun}\AgdaSpace{}%
\AgdaBound{u'}\<%
\\
%
\>[4]\AgdaFunction{g}\AgdaSymbol{\{}\AgdaBound{u}\AgdaSymbol{\}\{}\AgdaBound{u'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{af12}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaFunction{contradiction}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚äë-conj-R2}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaBound{af12}\<%
\end{code}
\end{fence}

The property of being greater than a function value is decidable, as
exhibited by the following function.

\begin{fence}
\begin{code}%
\>[0]\AgdaFunction{above-fun?}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{v}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Value}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaRecord{Dec}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{above-fun}\AgdaSpace{}%
\AgdaBound{v}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{above-fun?}\AgdaSpace{}%
\AgdaInductiveConstructor{‚ä•}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaFunction{above-fun‚ä•}\<%
\\
\>[0]\AgdaFunction{above-fun?}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚Ü¶}}\AgdaSpace{}%
\AgdaBound{w}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{‚äë-refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[0]\AgdaFunction{above-fun?}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{u}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äî}}\AgdaSpace{}%
\AgdaBound{u'}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{above-fun?}\AgdaSpace{}%
\AgdaBound{u}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaFunction{above-fun?}\AgdaSpace{}%
\AgdaBound{u'}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚äë-conj-R1}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚äë-conj-R2}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{not-above-fun-‚äî}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{y}\AgdaSymbol{)}\<%
\end{code}
\end{fence}

\hypertarget{relating-values-to-closures}{%
\section{Relating values to
closures}\label{relating-values-to-closures}}

Next we relate semantic values to closures. The relation \texttt{ùïç} is
for closures whose term is a lambda abstraction, i.e., in weak-head
normal form (WHNF). The relation ùîº is for any closure. Roughly speaking,
\texttt{ùîº\ v\ c} will hold if, when \texttt{v} is greater than a
function value, \texttt{c} evaluates to a closure
\texttt{c\textquotesingle{}} in WHNF and
\texttt{ùïç\ v\ c\textquotesingle{}}. Regarding \texttt{ùïç\ v\ c}, it will
hold when \texttt{c} is in WHNF, and if \texttt{v} is a function, the
body of \texttt{c} evaluates according to \texttt{v}.

\begin{fence}
\begin{code}%
\>[0]\AgdaFunction{ùïç}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Value}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Clos}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\<%
\\
\>[0]\AgdaFunction{ùîº}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Value}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Clos}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\<%
\end{code}
\end{fence}

We define \texttt{ùïç} as a function from values and closures to
\texttt{Set} and not as a data type because it is mutually recursive
with \texttt{ùîº} in a negative position (to the left of an implication).
We first perform case analysis on the term in the closure. If the term
is a variable or application, then \texttt{ùïç} is false (\texttt{Bot}).
If the term is a lambda abstraction, we define \texttt{ùïç} by recursion
on the value, which we describe below.

\begin{fence}
\begin{code}%
\>[0]\AgdaFunction{ùïç}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{`}}\AgdaSpace{}%
\AgdaBound{x‚ÇÅ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{Bot}\<%
\\
\>[0]\AgdaFunction{ùïç}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{M}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{¬∑}}\AgdaSpace{}%
\AgdaBound{M‚ÇÅ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{Bot}\<%
\\
\>[0]\AgdaFunction{ùïç}\AgdaSpace{}%
\AgdaInductiveConstructor{‚ä•}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{M}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaRecord{‚ä§}\<%
\\
\>[0]\AgdaFunction{ùïç}%
\>[589I]\AgdaSymbol{(}\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚Ü¶}}\AgdaSpace{}%
\AgdaBound{w}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[589I][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{(‚àÄ\{}\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Clos}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{ùîº}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{above-fun}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{Œ£[}\AgdaSpace{}%
\AgdaBound{c'}\AgdaSpace{}%
\AgdaFunction{‚àà}\AgdaSpace{}%
\AgdaDatatype{Clos}\AgdaSpace{}%
\AgdaFunction{]}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{(}\AgdaBound{Œ≥}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,'}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaBound{N}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚áì}}\AgdaSpace{}%
\AgdaBound{c'}%
\>[27]\AgdaOperator{\AgdaFunction{√ó}}%
\>[30]\AgdaFunction{ùïç}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaBound{c'}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{ùïç}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{u}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äî}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{ùïç}\AgdaSpace{}%
\AgdaBound{u}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{√ó}}\AgdaSpace{}%
\AgdaFunction{ùïç}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSymbol{)}\<%
\end{code}
\end{fence}

\begin{itemize}
\item
  If the value is \texttt{‚ä•}, then the result is true (\texttt{‚ä§}).
\item
  If the value is a join (u ‚äî v), then the result is the pair
  (conjunction) of ùïç is true for both u and v.
\item
  The important case is for a function value \texttt{v\ ‚Ü¶\ w} and
  closure \texttt{clos\ (∆õ\ N)\ Œ≥}. Given any closure \texttt{c} such
  that \texttt{ùîº\ v\ c}, if \texttt{w} is greater than a function, then
  \texttt{N} evaluates (with \texttt{Œ≥} extended with \texttt{c}) to
  some closure \texttt{c\textquotesingle{}} and we have
  \texttt{ùïç\ w\ c\textquotesingle{}}.
\end{itemize}

The definition of \texttt{ùîº} is straightforward. If \texttt{v} is a
greater than a function, then \texttt{M} evaluates to a closure related
to \texttt{v}.

\begin{fence}
\begin{code}%
\>[0]\AgdaFunction{ùîº}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaBound{M}\AgdaSpace{}%
\AgdaBound{Œ≥'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{above-fun}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{Œ£[}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaFunction{‚àà}\AgdaSpace{}%
\AgdaDatatype{Clos}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaBound{Œ≥'}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaBound{M}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚áì}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{√ó}}\AgdaSpace{}%
\AgdaFunction{ùïç}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaBound{c}\<%
\end{code}
\end{fence}

The proof of the main lemma is by induction on \texttt{Œ≥\ ‚ä¢\ M\ ‚Üì\ v},
so it goes underneath lambda abstractions and must therefore reason
about open terms (terms with variables). So we must relate environments
of semantic values to environments of closures. In the following,
\texttt{ùîæ} relates \texttt{Œ≥} to \texttt{Œ≥\textquotesingle{}} if the
corresponding values and closures are related by \texttt{ùîº}.

\begin{fence}
\begin{code}%
\>[0]\AgdaFunction{ùîæ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{Env}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{ClosEnv}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\<%
\\
\>[0]\AgdaFunction{ùîæ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSpace{}%
\AgdaBound{Œ≥'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚àã}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{ùîº}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Œ≥}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Œ≥'}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{ùîæ-‚àÖ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{ùîæ}\AgdaSpace{}%
\AgdaFunction{`‚àÖ}\AgdaSpace{}%
\AgdaFunction{‚àÖ'}\<%
\\
\>[0]\AgdaFunction{ùîæ-‚àÖ}\AgdaSpace{}%
\AgdaSymbol{\{()\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{ùîæ-ext}%
\>[693I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSymbol{\}\{}\AgdaBound{Œ≥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Env}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{\}\{}\AgdaBound{Œ≥'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{ClosEnv}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{\}\{}\AgdaBound{v}\AgdaSpace{}%
\AgdaBound{c}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[693I]%
\>[6]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{ùîæ}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSpace{}%
\AgdaBound{Œ≥'}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{ùîº}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{ùîæ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Œ≥}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{`,}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Œ≥'}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,'}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{ùîæ-ext}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œ≥}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œ≥'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{Z}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{e}\<%
\\
\>[0]\AgdaFunction{ùîæ-ext}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œ≥}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œ≥'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaInductiveConstructor{S}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{g}\<%
\end{code}
\end{fence}

We need a few properties of the \texttt{ùïç} and \texttt{ùîº} relations. The
first is that a closure in the \texttt{ùïç} relation must be in weak-head
normal form. We define WHNF has follows.

\begin{fence}
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{WHNF}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaInductiveConstructor{∆õ\AgdaUnderscore{}}}%
\>[746I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{N}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[746I]%
\>[5]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{WHNF}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{)}\<%
\end{code}
\end{fence}

The proof goes by cases on the term in the closure.

\begin{fence}
\begin{code}%
\>[0]\AgdaFunction{ùïç‚ÜíWHNF}%
\>[759I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSymbol{\}\{}\AgdaBound{Œ≥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{ClosEnv}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{\}\{}\AgdaBound{M}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSymbol{\}\{}\AgdaBound{v}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[759I]%
\>[7]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{ùïç}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaBound{M}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{WHNF}\AgdaSpace{}%
\AgdaBound{M}\<%
\\
\>[0]\AgdaFunction{ùïç‚ÜíWHNF}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{M}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{`}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{v}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{()}\<%
\\
\>[0]\AgdaFunction{ùïç‚ÜíWHNF}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{M}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{v}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{vc}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∆õ\AgdaUnderscore{}}}\<%
\\
\>[0]\AgdaFunction{ùïç‚ÜíWHNF}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{M}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{L}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{¬∑}}\AgdaSpace{}%
\AgdaBound{M}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{v}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{()}\<%
\end{code}
\end{fence}

Next we have an introduction rule for \texttt{ùïç} that mimics the
\texttt{‚äî-intro} rule. If both \texttt{u} and \texttt{v} are related to
a closure \texttt{c}, then their join is too.

\begin{fence}
\begin{code}%
\>[0]\AgdaFunction{ùïç‚äî-intro}%
\>[797I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{u}\AgdaSpace{}%
\AgdaBound{v}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[797I]%
\>[9]\AgdaSymbol{‚Üí}%
\>[801I]\AgdaFunction{ùïç}\AgdaSpace{}%
\AgdaBound{u}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{ùïç}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaBound{c}\<%
\\
\>[.][@{}l@{}]\<[801I]%
\>[11]\AgdaComment{---------------}\<%
\\
%
\>[9]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{ùïç}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{u}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äî}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{c}\<%
\\
\>[0]\AgdaFunction{ùïç‚äî-intro}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{`}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{()}\AgdaSpace{}%
\AgdaBound{vc}\<%
\\
\>[0]\AgdaFunction{ùïç‚äî-intro}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{uc}\AgdaSpace{}%
\AgdaBound{vc}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{uc}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{vc}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[0]\AgdaFunction{ùïç‚äî-intro}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{L}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{¬∑}}\AgdaSpace{}%
\AgdaBound{M}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{()}\AgdaSpace{}%
\AgdaBound{vc}\<%
\end{code}
\end{fence}

In a moment we prove that \texttt{ùïç} is preserved when going from a
greater value to a lesser value: if \texttt{ùïç\ v\ c} and
\texttt{v\textquotesingle{}\ ‚äë\ v}, then
\texttt{ùïç\ v\textquotesingle{}\ c}. This property, named \texttt{ùïç-sub},
is needed by the main lemma in the case for the \texttt{sub} rule.

To prove \texttt{ùïç-sub}, we in turn need the following property
concerning values that are not greater than a function, that is, values
that are equivalent to \texttt{‚ä•}. In such cases,
\texttt{ùïç\ v\ (clos\ (∆õ\ N)\ Œ≥\textquotesingle{})} is trivially true.

\begin{fence}
\begin{code}%
\>[0]\AgdaFunction{not-above-fun-ùïç}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{v}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Value}\AgdaSymbol{\}\{}\AgdaBound{Œì}\AgdaSymbol{\}\{}\AgdaBound{Œ≥'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{ClosEnv}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{\}\{}\AgdaBound{N}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{‚Üí}%
\>[852I]\AgdaOperator{\AgdaFunction{¬¨}}\AgdaSpace{}%
\AgdaFunction{above-fun}\AgdaSpace{}%
\AgdaBound{v}\<%
\\
\>[.][@{}l@{}]\<[852I]%
\>[6]\AgdaComment{-------------------}\<%
\\
%
\>[4]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{ùïç}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥'}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{not-above-fun-ùïç}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{‚ä•}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{af}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\<%
\\
\>[0]\AgdaFunction{not-above-fun-ùïç}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚Ü¶}}\AgdaSpace{}%
\AgdaBound{v'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{af}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{‚ä•-elim}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{contradiction}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{v'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{‚äë-refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaBound{af}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{not-above-fun-ùïç}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{v‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äî}}\AgdaSpace{}%
\AgdaBound{v‚ÇÇ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{af}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{not-above-fun-‚äî-inv}\AgdaSpace{}%
\AgdaBound{af}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{af1}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{af2}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaFunction{not-above-fun-ùïç}\AgdaSpace{}%
\AgdaBound{af1}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{not-above-fun-ùïç}\AgdaSpace{}%
\AgdaBound{af2}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\end{code}
\end{fence}

The proofs of \texttt{ùïç-sub} and \texttt{ùîº-sub} are intertwined.

\begin{fence}
\begin{code}%
\>[0]\AgdaFunction{sub-ùïç}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Clos}\AgdaSymbol{\}\{}\AgdaBound{v}\AgdaSpace{}%
\AgdaBound{v'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{ùïç}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{v'}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äë}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{ùïç}\AgdaSpace{}%
\AgdaBound{v'}\AgdaSpace{}%
\AgdaBound{c}\<%
\\
\>[0]\AgdaFunction{sub-ùîº}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Clos}\AgdaSymbol{\}\{}\AgdaBound{v}\AgdaSpace{}%
\AgdaBound{v'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{ùîº}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{v'}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚äë}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{ùîº}\AgdaSpace{}%
\AgdaBound{v'}\AgdaSpace{}%
\AgdaBound{c}\<%
\end{code}
\end{fence}

We prove \texttt{ùïç-sub} by case analysis on the closure's term, to
dispatch the cases for variables and application. We then proceed by
induction on \texttt{v\textquotesingle{}\ ‚äë\ v}. We describe each case
below.

\begin{fence}
\begin{code}%
\>[0]\AgdaFunction{sub-ùïç}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{`}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{v}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{()}\AgdaSpace{}%
\AgdaBound{lt}\<%
\\
\>[0]\AgdaFunction{sub-ùïç}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{L}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{¬∑}}\AgdaSpace{}%
\AgdaBound{M}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{()}\AgdaSpace{}%
\AgdaBound{lt}\<%
\\
\>[0]\AgdaFunction{sub-ùïç}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{vc}\AgdaSpace{}%
\AgdaInductiveConstructor{‚äë-bot}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\<%
\\
\>[0]\AgdaFunction{sub-ùïç}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{vc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚äë-conj-L}\AgdaSpace{}%
\AgdaBound{lt1}\AgdaSpace{}%
\AgdaBound{lt2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub-ùïç}\AgdaSpace{}%
\AgdaBound{vc}\AgdaSpace{}%
\AgdaBound{lt1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{sub-ùïç}\AgdaSpace{}%
\AgdaBound{vc}\AgdaSpace{}%
\AgdaBound{lt2}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[0]\AgdaFunction{sub-ùïç}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{vv1}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{vv2}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚äë-conj-R1}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{sub-ùïç}\AgdaSpace{}%
\AgdaBound{vv1}\AgdaSpace{}%
\AgdaBound{lt}\<%
\\
\>[0]\AgdaFunction{sub-ùïç}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{vv1}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{vv2}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚äë-conj-R2}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{sub-ùïç}\AgdaSpace{}%
\AgdaBound{vv2}\AgdaSpace{}%
\AgdaBound{lt}\<%
\\
\>[0]\AgdaFunction{sub-ùïç}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{vc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚äë-trans}\AgdaSymbol{\{}\AgdaArgument{v}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{v‚ÇÇ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{lt1}\AgdaSpace{}%
\AgdaBound{lt2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{sub-ùïç}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub-ùïç}\AgdaSpace{}%
\AgdaBound{vc}\AgdaSpace{}%
\AgdaBound{lt2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{lt1}\<%
\\
\>[0]\AgdaFunction{sub-ùïç}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{vc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚äë-fun}\AgdaSpace{}%
\AgdaBound{lt1}\AgdaSpace{}%
\AgdaBound{lt2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ev1}\AgdaSpace{}%
\AgdaBound{sf}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{vc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub-ùîº}\AgdaSpace{}%
\AgdaBound{ev1}\AgdaSpace{}%
\AgdaBound{lt1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{above-fun-‚äë}\AgdaSpace{}%
\AgdaBound{sf}\AgdaSpace{}%
\AgdaBound{lt2}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{Nc}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{v4}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{Nc}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{sub-ùïç}\AgdaSpace{}%
\AgdaBound{v4}\AgdaSpace{}%
\AgdaBound{lt2}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[0]\AgdaFunction{sub-ùïç}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚Ü¶}}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äî}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚Ü¶}}\AgdaSpace{}%
\AgdaBound{w'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{vcw}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{vcw'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚äë-dist}\AgdaSpace{}%
\AgdaBound{ev1c}\AgdaSpace{}%
\AgdaBound{sf}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{above-fun?}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaFunction{above-fun?}\AgdaSpace{}%
\AgdaBound{w'}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[1085I]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaBound{af2}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaBound{af3}\<%
\\
\>[.][@{}l@{}]\<[1085I]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{vcw}\AgdaSpace{}%
\AgdaBound{ev1c}\AgdaSpace{}%
\AgdaBound{af2}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{vcw'}\AgdaSpace{}%
\AgdaBound{ev1c}\AgdaSpace{}%
\AgdaBound{af3}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[1098I]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaBound{L}\AgdaSpace{}%
\AgdaBound{Œ¥}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{L‚áìc‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ùïçw}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[.][@{}l@{}]\<[1098I]%
\>[4]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{c‚ÇÉ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{L‚áìc‚ÇÉ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ùïçw'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaFunction{‚áì-determ}\AgdaSpace{}%
\AgdaBound{L‚áìc‚ÇÉ}\AgdaSpace{}%
\AgdaBound{L‚áìc‚ÇÇ}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{ùïç‚ÜíWHNF}\AgdaSpace{}%
\AgdaBound{ùïçw}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}%
\>[1127I]\AgdaOperator{\AgdaInductiveConstructor{∆õ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[.][@{}l@{}]\<[1127I]%
\>[6]\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaBound{L}\AgdaSpace{}%
\AgdaBound{Œ¥}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{L‚áìc‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{ùïçw}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ùïçw'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[0]\AgdaFunction{sub-ùïç}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{c}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚Ü¶}}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äî}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚Ü¶}}\AgdaSpace{}%
\AgdaBound{w'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{vcw}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{vcw'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}%
\>[43]\AgdaInductiveConstructor{‚äë-dist}\AgdaSpace{}%
\AgdaBound{ev1c}\AgdaSpace{}%
\AgdaBound{sf}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaBound{af2}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaBound{naf3}\<%
\\
%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{vcw}\AgdaSpace{}%
\AgdaBound{ev1c}\AgdaSpace{}%
\AgdaBound{af2}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[1166I]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œì'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{L}\AgdaSpace{}%
\AgdaBound{Œ≥‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{L‚áìc2}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ùïçw}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[.][@{}l@{}]\<[1166I]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{ùïç‚ÜíWHNF}\AgdaSpace{}%
\AgdaBound{ùïçw}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}%
\>[1182I]\AgdaOperator{\AgdaInductiveConstructor{∆õ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{N}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{N'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[.][@{}l@{}]\<[1182I]%
\>[6]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaBound{ùïçw'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{not-above-fun-ùïç}\AgdaSymbol{\{}\AgdaBound{w'}\AgdaSymbol{\}\{}\AgdaBound{Œì'}\AgdaSymbol{\}\{}\AgdaBound{Œ≥‚ÇÅ}\AgdaSymbol{\}\{}\AgdaBound{N'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{naf3}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
%
\>[6]\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{L‚áìc2}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{ùïç‚äî-intro}\AgdaSpace{}%
\AgdaBound{ùïçw}\AgdaSpace{}%
\AgdaBound{ùïçw'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[0]\AgdaFunction{sub-ùïç}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{c}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚Ü¶}}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äî}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚Ü¶}}\AgdaSpace{}%
\AgdaBound{w'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{vcw}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{vcw'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚äë-dist}\AgdaSpace{}%
\AgdaBound{ev1c}\AgdaSpace{}%
\AgdaBound{sf}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaBound{naf2}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaBound{af3}\<%
\\
%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{vcw'}\AgdaSpace{}%
\AgdaBound{ev1c}\AgdaSpace{}%
\AgdaBound{af3}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[1229I]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œì'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{L}\AgdaSpace{}%
\AgdaBound{Œ≥‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{L‚áìc3}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ùïçw'c}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[.][@{}l@{}]\<[1229I]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{ùïç‚ÜíWHNF}\AgdaSpace{}%
\AgdaBound{ùïçw'c}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}%
\>[1245I]\AgdaOperator{\AgdaInductiveConstructor{∆õ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{N}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{N'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[.][@{}l@{}]\<[1245I]%
\>[6]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaBound{ùïçwc}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{not-above-fun-ùïç}\AgdaSymbol{\{}\AgdaBound{w}\AgdaSymbol{\}\{}\AgdaBound{Œì'}\AgdaSymbol{\}\{}\AgdaBound{Œ≥‚ÇÅ}\AgdaSymbol{\}\{}\AgdaBound{N'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{naf2}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
%
\>[6]\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{L‚áìc3}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{ùïç‚äî-intro}\AgdaSpace{}%
\AgdaBound{ùïçwc}\AgdaSpace{}%
\AgdaBound{ùïçw'c}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[0]\AgdaFunction{sub-ùïç}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{c}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚Ü¶}}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚äî}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚Ü¶}}\AgdaSpace{}%
\AgdaBound{w'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{vcw}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{vcw'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚äë-dist}\AgdaSpace{}%
\AgdaBound{ev1c}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{v'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{w''}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaBound{naf2}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaBound{naf3}\<%
\\
%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{above-fun-‚äî}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{v'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{w''}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaBound{af2}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{‚ä•-elim}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{contradiction}\AgdaSpace{}%
\AgdaBound{af2}\AgdaSpace{}%
\AgdaBound{naf2}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaBound{af3}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{‚ä•-elim}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{contradiction}\AgdaSpace{}%
\AgdaBound{af3}\AgdaSpace{}%
\AgdaBound{naf3}\AgdaSymbol{)}\<%
\end{code}
\end{fence}

\begin{itemize}
\item
  Case \texttt{‚äë-bot}. We immediately have
  \texttt{ùïç\ ‚ä•\ (clos\ (∆õ\ N)\ Œ≥)}.
\item
  Case \texttt{‚äë-conj-L}.

  \begin{myDisplay}
    v‚ÇÅ' ‚äë v     v‚ÇÇ' ‚äë v
    -------------------
    (v‚ÇÅ' ‚äî v‚ÇÇ') ‚äë v
  \end{myDisplay}

  The induction hypotheses gives us
  \texttt{ùïç\ v‚ÇÅ\textquotesingle{}\ (clos\ (∆õ\ N)\ Œ≥)} and
  \texttt{ùïç\ v‚ÇÇ\textquotesingle{}\ (clos\ (∆õ\ N)\ Œ≥)}, which is all we
  need for this case.
\item
  Case \texttt{‚äë-conj-R1}.

  \begin{myDisplay}
    v' ‚äë v‚ÇÅ
    -------------
    v' ‚äë (v‚ÇÅ ‚äî v‚ÇÇ)
  \end{myDisplay}

  The induction hypothesis gives us
  \texttt{ùïç\ v\textquotesingle{}\ (clos\ (∆õ\ N)\ Œ≥)}.
\item
  Case \texttt{‚äë-conj-R2}.

  \begin{myDisplay}
    v' ‚äë v‚ÇÇ
    -------------
    v' ‚äë (v‚ÇÅ ‚äî v‚ÇÇ)
  \end{myDisplay}

  Again, the induction hypothesis gives us
  \texttt{ùïç\ v\textquotesingle{}\ (clos\ (∆õ\ N)\ Œ≥)}.
\item
  Case \texttt{‚äë-trans}.

  \begin{myDisplay}
    v' ‚äë v‚ÇÇ   v‚ÇÇ ‚äë v
    -----------------
         v' ‚äë v
  \end{myDisplay}

  The induction hypothesis for \texttt{v‚ÇÇ\ ‚äë\ v} gives us
  \texttt{ùïç\ v‚ÇÇ\ (clos\ (∆õ\ N)\ Œ≥)}. We apply the induction hypothesis
  for \texttt{v\textquotesingle{}\ ‚äë\ v‚ÇÇ} to conclude that
  \texttt{ùïç\ v\textquotesingle{}\ (clos\ (∆õ\ N)\ Œ≥)}.
\item
  Case \texttt{‚äë-dist}. This case is the most difficult. We have

  \begin{myDisplay}
    ùïç (v ‚Ü¶ w) (clos (∆õ N) Œ≥)
    ùïç (v ‚Ü¶ w') (clos (∆õ N) Œ≥)
  \end{myDisplay}

  and need to show that

  \begin{myDisplay}
    ùïç (v ‚Ü¶ (w ‚äî w')) (clos (∆õ N) Œ≥)
  \end{myDisplay}

  Let \texttt{c} be an arbitrary closure such that \texttt{ùîº\ v\ c}.
  Assume \texttt{w\ ‚äî\ w\textquotesingle{}} is greater than a function.
  Unfortunately, this does not mean that both \texttt{w} and
  \texttt{w\textquotesingle{}} are above functions. But thanks to the
  lemma \texttt{above-fun-‚äî}, we know that at least one of them is
  greater than a function.

  \begin{itemize}
  \item
    Suppose both of them are greater than a function. Then we have
    \texttt{Œ≥\ ‚ä¢\ N\ ‚áì\ clos\ L\ Œ¥} and \texttt{ùïç\ w\ (clos\ L\ Œ¥)}. We
    also have \texttt{Œ≥\ ‚ä¢\ N\ ‚áì\ c‚ÇÉ} and
    \texttt{ùïç\ w\textquotesingle{}\ c‚ÇÉ}. Because the big-step semantics
    is deterministic, we have \texttt{c‚ÇÉ\ ‚â°\ clos\ L\ Œ¥}. Also, from
    \texttt{ùïç\ w\ (clos\ L\ Œ¥)} we know that
    \texttt{L\ ‚â°\ ∆õ\ N\textquotesingle{}} for some
    \texttt{N\textquotesingle{}}. We conclude that
    \texttt{ùïç\ (w\ ‚äî\ w\textquotesingle{})\ (clos\ (∆õ\ N\textquotesingle{})\ Œ¥)}.
  \item
    Suppose one of them is greater than a function and the other is not:
    say \texttt{above-fun\ w} and
    \texttt{¬¨\ above-fun\ w\textquotesingle{}}. Then from
    \texttt{ùïç\ (v\ ‚Ü¶\ w)\ (clos\ (∆õ\ N)\ Œ≥)} we have
    \texttt{Œ≥\ ‚ä¢\ N\ ‚áì\ clos\ L\ Œ≥‚ÇÅ} and \texttt{ùïç\ w\ (clos\ L\ Œ≥‚ÇÅ)}.
    From this we have \texttt{L\ ‚â°\ ∆õ\ N\textquotesingle{}} for some
    \texttt{N\textquotesingle{}}. Meanwhile, from
    \texttt{¬¨\ above-fun\ w\textquotesingle{}} we have
    \texttt{ùïç\ w\textquotesingle{}\ (clos\ L\ Œ≥‚ÇÅ)}. We conclude that
    \texttt{ùïç\ (w\ ‚äî\ w\textquotesingle{})\ (clos\ (∆õ\ N\textquotesingle{})\ Œ≥‚ÇÅ)}.
  \end{itemize}
\end{itemize}

The proof of \texttt{sub-ùîº} is direct and explained below.

\begin{fence}
\begin{code}%
\>[0]\AgdaFunction{sub-ùîº}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaBound{M}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{v}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{v'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ùîºv}\AgdaSpace{}%
\AgdaBound{v'‚äëv}\AgdaSpace{}%
\AgdaBound{fv'}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{ùîºv}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{above-fun-‚äë}\AgdaSpace{}%
\AgdaBound{fv'}\AgdaSpace{}%
\AgdaBound{v'‚äëv}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}%
\>[1336I]\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{M‚áìc}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ùïçv}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[.][@{}l@{}]\<[1336I]%
\>[6]\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{M‚áìc}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{sub-ùïç}\AgdaSpace{}%
\AgdaBound{ùïçv}\AgdaSpace{}%
\AgdaBound{v'‚äëv}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\end{code}
\end{fence}

From \texttt{above-fun\ v\textquotesingle{}} and
\texttt{v\textquotesingle{}\ ‚äë\ v} we have \texttt{above-fun\ v}. Then
with \texttt{ùîº\ v\ c} we obtain a closure \texttt{c} such that
\texttt{Œ≥\ ‚ä¢\ M\ ‚áì\ c} and \texttt{ùïç\ v\ c}. We conclude with an
application of \texttt{sub-ùïç} with \texttt{v\textquotesingle{}\ ‚äë\ v} to
show \texttt{ùïç\ v\textquotesingle{}\ c}.

\hypertarget{programs-with-function-denotation-terminate-via-call-by-name}{%
\section{Programs with function denotation terminate via
call-by-name}\label{programs-with-function-denotation-terminate-via-call-by-name}}

The main lemma proves that if a term has a denotation that is above a
function, then it terminates via call-by-name. More formally, if
\texttt{Œ≥\ ‚ä¢\ M\ ‚Üì\ v} and \texttt{ùîæ\ Œ≥\ Œ≥\textquotesingle{}}, then
\texttt{ùîº\ v\ (clos\ M\ Œ≥\textquotesingle{})}. The proof is by induction
on the derivation of \texttt{Œ≥\ ‚ä¢\ M\ ‚Üì\ v} we discuss each case below.

The following lemma, kth-x, is used in the case for the \texttt{var}
rule.

\begin{fence}
\begin{code}%
\>[0]\AgdaFunction{kth-x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSymbol{\}\{}\AgdaBound{Œ≥'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{ClosEnv}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{\}\{}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚àã}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[5]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{Œ£[}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaFunction{‚àà}%
\>[1368I]\AgdaDatatype{Context}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaFunction{Œ£[}\AgdaSpace{}%
\AgdaBound{Œ¥}\AgdaSpace{}%
\AgdaFunction{‚àà}\AgdaSpace{}%
\AgdaFunction{ClosEnv}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaFunction{Œ£[}\AgdaSpace{}%
\AgdaBound{M}\AgdaSpace{}%
\AgdaFunction{‚àà}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSpace{}%
\AgdaFunction{]}\<%
\\
\>[1368I][@{}l@{\AgdaIndent{0}}]%
\>[17]\AgdaBound{Œ≥'}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaBound{M}\AgdaSpace{}%
\AgdaBound{Œ¥}\<%
\\
\>[0]\AgdaFunction{kth-x}\AgdaSymbol{\{}\AgdaArgument{Œ≥'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{Œ≥'}\AgdaSymbol{\}\{}\AgdaArgument{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{Œ≥'}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{clos}\AgdaSymbol{\{}\AgdaArgument{Œì}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{M}\AgdaSpace{}%
\AgdaBound{Œ¥}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{Œ¥}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{M}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\end{code}
\end{fence}

\begin{fence}
\begin{code}%
\>[0]\AgdaFunction{‚Üì‚Üíùîº}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[1416I]\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSymbol{\}\{}\AgdaBound{Œ≥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Env}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{\}\{}\AgdaBound{Œ≥'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{ClosEnv}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{\}\{}\AgdaBound{M}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSpace{}%
\AgdaSymbol{\}\{}\AgdaBound{v}\AgdaSymbol{\}}\<%
\\
\>[1416I][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{ùîæ}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSpace{}%
\AgdaBound{Œ≥'}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaBound{M}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚Üì}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{ùîº}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaBound{M}\AgdaSpace{}%
\AgdaBound{Œ≥'}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{‚Üì‚Üíùîº}%
\>[1443I]\AgdaSymbol{\{}\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œ≥}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œ≥'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ùîæŒ≥Œ≥'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{var}\AgdaSymbol{\{}\AgdaArgument{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaBound{fŒ≥x}\<%
\\
\>[.][@{}l@{}]\<[1443I]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{kth-x}\AgdaSymbol{\{}\AgdaBound{Œì}\AgdaSymbol{\}\{}\AgdaBound{Œ≥'}\AgdaSymbol{\}\{}\AgdaBound{x}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{ùîæŒ≥Œ≥'}\AgdaSymbol{\{}\AgdaArgument{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[1456I]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{Œ¥}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{M'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{ùîæŒ≥Œ≥'x}\AgdaSpace{}%
\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaBound{eq}\<%
\\
\>[.][@{}l@{}]\<[1456I]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{ùîæŒ≥Œ≥'x}\AgdaSpace{}%
\AgdaBound{fŒ≥x}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}%
\>[1477I]\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{M'‚áìc}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ùïçŒ≥x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[.][@{}l@{}]\<[1477I]%
\>[6]\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚áì-var}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSpace{}%
\AgdaBound{M'‚áìc}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ùïçŒ≥x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[0]\AgdaFunction{‚Üì‚Üíùîº}%
\>[1497I]\AgdaSymbol{\{}\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œ≥}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œ≥'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ùîæŒ≥Œ≥'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚Ü¶-elim}\AgdaSymbol{\{}\AgdaArgument{L}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{L}\AgdaSymbol{\}\{}\AgdaArgument{M}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{M}\AgdaSymbol{\}\{}\AgdaArgument{v}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{v‚ÇÅ}\AgdaSymbol{\}\{}\AgdaArgument{w}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{v}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{d‚ÇÅ}\AgdaSpace{}%
\AgdaBound{d‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{fv}\<%
\\
\>[.][@{}l@{}]\<[1497I]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚Üì‚Üíùîº}\AgdaSpace{}%
\AgdaBound{ùîæŒ≥Œ≥'}\AgdaSpace{}%
\AgdaBound{d‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{v‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{‚äë-refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[1525I]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaBound{L'}\AgdaSpace{}%
\AgdaBound{Œ¥}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{L‚áìL'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ùïçv‚ÇÅ‚Ü¶v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[.][@{}l@{}]\<[1525I]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{ùïç‚ÜíWHNF}\AgdaSpace{}%
\AgdaBound{ùïçv‚ÇÅ‚Ü¶v}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[1539I]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∆õ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{N}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[1539I]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{ùïçv‚ÇÅ‚Ü¶v}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaBound{M}\AgdaSpace{}%
\AgdaBound{Œ≥'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{‚Üì‚Üíùîº}\AgdaSpace{}%
\AgdaBound{ùîæŒ≥Œ≥'}\AgdaSpace{}%
\AgdaBound{d‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{fv}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[1552I]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{c'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{N‚áìc'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ùïçv}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[.][@{}l@{}]\<[1552I]%
\>[4]\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{c'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚áì-app}\AgdaSpace{}%
\AgdaBound{L‚áìL'}\AgdaSpace{}%
\AgdaBound{N‚áìc'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ùïçv}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[0]\AgdaFunction{‚Üì‚Üíùîº}%
\>[1573I]\AgdaSymbol{\{}\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œ≥}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œ≥'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ùîæŒ≥Œ≥'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚Ü¶-intro}\AgdaSymbol{\{}\AgdaArgument{N}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{\}\{}\AgdaArgument{v}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{v}\AgdaSymbol{\}\{}\AgdaArgument{w}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{w}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{d}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{fv‚Ü¶w}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[.][@{}l@{}]\<[1573I]%
\>[4]\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚áì-lam}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{E}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
%
\>[4]\AgdaKeyword{where}%
\>[1598I]\AgdaFunction{E}%
\>[1599I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Clos}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{ùîº}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{above-fun}\AgdaSpace{}%
\AgdaBound{w}\<%
\\
\>[.][@{}l@{}]\<[1599I]%
\>[12]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{Œ£[}\AgdaSpace{}%
\AgdaBound{c'}\AgdaSpace{}%
\AgdaFunction{‚àà}\AgdaSpace{}%
\AgdaDatatype{Clos}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Œ≥'}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{,'}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaBound{N}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚áì}}\AgdaSpace{}%
\AgdaBound{c'}%
\>[49]\AgdaOperator{\AgdaFunction{√ó}}%
\>[52]\AgdaFunction{ùïç}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaBound{c'}\<%
\\
\>[.][@{}l@{}]\<[1598I]%
\>[10]\AgdaFunction{E}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{c}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ùîºvc}\AgdaSpace{}%
\AgdaBound{fw}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{‚Üì‚Üíùîº}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{ùîæ-ext}\AgdaSymbol{\{}\AgdaBound{Œì}\AgdaSymbol{\}\{}\AgdaBound{Œ≥}\AgdaSymbol{\}\{}\AgdaBound{Œ≥'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ùîæŒ≥Œ≥'}\AgdaSpace{}%
\AgdaBound{ùîºvc}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{fw}\<%
\\
\>[0]\AgdaFunction{‚Üì‚Üíùîº}\AgdaSpace{}%
\AgdaBound{ùîæŒ≥Œ≥'}\AgdaSpace{}%
\AgdaInductiveConstructor{‚ä•-intro}\AgdaSpace{}%
\AgdaBound{f‚ä•}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{‚ä•-elim}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{above-fun‚ä•}\AgdaSpace{}%
\AgdaBound{f‚ä•}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{‚Üì‚Üíùîº}%
\>[1645I]\AgdaBound{ùîæŒ≥Œ≥'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚äî-intro}\AgdaSymbol{\{}\AgdaArgument{v}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{v‚ÇÅ}\AgdaSymbol{\}\{}\AgdaArgument{w}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{v‚ÇÇ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{d‚ÇÅ}\AgdaSpace{}%
\AgdaBound{d‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{fv12}\<%
\\
\>[.][@{}l@{}]\<[1645I]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{above-fun?}\AgdaSpace{}%
\AgdaBound{v‚ÇÅ}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaFunction{above-fun?}\AgdaSpace{}%
\AgdaBound{v‚ÇÇ}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[1659I]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaBound{fv1}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaBound{fv2}\<%
\\
\>[.][@{}l@{}]\<[1659I]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚Üì‚Üíùîº}\AgdaSpace{}%
\AgdaBound{ùîæŒ≥Œ≥'}\AgdaSpace{}%
\AgdaBound{d‚ÇÅ}\AgdaSpace{}%
\AgdaBound{fv1}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaFunction{‚Üì‚Üíùîº}\AgdaSpace{}%
\AgdaBound{ùîæŒ≥Œ≥'}\AgdaSpace{}%
\AgdaBound{d‚ÇÇ}\AgdaSpace{}%
\AgdaBound{fv2}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[1674I]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{c‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{M‚áìc‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ùïçv‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{c‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{M‚áìc‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ùïçv‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[.][@{}l@{}]\<[1674I]%
\>[4]\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaFunction{‚áì-determ}\AgdaSpace{}%
\AgdaBound{M‚áìc‚ÇÇ}\AgdaSpace{}%
\AgdaBound{M‚áìc‚ÇÅ}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
%
\>[4]\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{c‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{M‚áìc‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{ùïç‚äî-intro}\AgdaSpace{}%
\AgdaBound{ùïçv‚ÇÅ}\AgdaSpace{}%
\AgdaBound{ùïçv‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[0]\AgdaFunction{‚Üì‚Üíùîº}%
\>[1708I]\AgdaBound{ùîæŒ≥Œ≥'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚äî-intro}\AgdaSymbol{\{}\AgdaArgument{v}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{v‚ÇÅ}\AgdaSymbol{\}\{}\AgdaArgument{w}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{v‚ÇÇ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{d‚ÇÅ}\AgdaSpace{}%
\AgdaBound{d‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{fv12}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaBound{fv1}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaBound{nfv2}\<%
\\
\>[.][@{}l@{}]\<[1708I]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚Üì‚Üíùîº}\AgdaSpace{}%
\AgdaBound{ùîæŒ≥Œ≥'}\AgdaSpace{}%
\AgdaBound{d‚ÇÅ}\AgdaSpace{}%
\AgdaBound{fv1}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[1727I]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œì'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{M'}\AgdaSpace{}%
\AgdaBound{Œ≥‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{M‚áìc‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ùïçv‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[.][@{}l@{}]\<[1727I]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{ùïç‚ÜíWHNF}\AgdaSpace{}%
\AgdaBound{ùïçv‚ÇÅ}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[1742I]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∆õ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{N}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[.][@{}l@{}]\<[1742I]%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaBound{ùïçv‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{not-above-fun-ùïç}\AgdaSymbol{\{}\AgdaBound{v‚ÇÇ}\AgdaSymbol{\}\{}\AgdaBound{Œì'}\AgdaSymbol{\}\{}\AgdaBound{Œ≥‚ÇÅ}\AgdaSymbol{\}\{}\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{nfv2}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
%
\>[4]\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{M‚áìc‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{ùïç‚äî-intro}\AgdaSpace{}%
\AgdaBound{ùïçv‚ÇÅ}\AgdaSpace{}%
\AgdaBound{ùïçv‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[0]\AgdaFunction{‚Üì‚Üíùîº}%
\>[1766I]\AgdaBound{ùîæŒ≥Œ≥'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚äî-intro}\AgdaSymbol{\{}\AgdaArgument{v}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{v‚ÇÅ}\AgdaSymbol{\}\{}\AgdaArgument{w}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{v‚ÇÇ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{d‚ÇÅ}\AgdaSpace{}%
\AgdaBound{d‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{fv12}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaBound{nfv1}%
\>[57]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaBound{fv2}\<%
\\
\>[.][@{}l@{}]\<[1766I]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚Üì‚Üíùîº}\AgdaSpace{}%
\AgdaBound{ùîæŒ≥Œ≥'}\AgdaSpace{}%
\AgdaBound{d‚ÇÇ}\AgdaSpace{}%
\AgdaBound{fv2}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[1784I]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œì'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{M'}\AgdaSpace{}%
\AgdaBound{Œ≥‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{M'‚áìc‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ùïç2c}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[.][@{}l@{}]\<[1784I]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{ùïç‚ÜíWHNF}\AgdaSpace{}%
\AgdaBound{ùïç2c}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[1799I]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∆õ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{N}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[.][@{}l@{}]\<[1799I]%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaBound{ùïç1c}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{not-above-fun-ùïç}\AgdaSymbol{\{}\AgdaBound{v‚ÇÅ}\AgdaSymbol{\}\{}\AgdaBound{Œì'}\AgdaSymbol{\}\{}\AgdaBound{Œ≥‚ÇÅ}\AgdaSymbol{\}\{}\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{nfv1}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
%
\>[4]\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{M'‚áìc‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{ùïç‚äî-intro}\AgdaSpace{}%
\AgdaBound{ùïç1c}\AgdaSpace{}%
\AgdaBound{ùïç2c}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[0]\AgdaFunction{‚Üì‚Üíùîº}%
\>[1823I]\AgdaBound{ùîæŒ≥Œ≥'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚äî-intro}\AgdaSpace{}%
\AgdaBound{d‚ÇÅ}\AgdaSpace{}%
\AgdaBound{d‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{fv12}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaBound{nfv1}%
\>[41]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaBound{nfv2}\<%
\\
\>[.][@{}l@{}]\<[1823I]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{above-fun-‚äî}\AgdaSpace{}%
\AgdaBound{fv12}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaBound{fv1}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{‚ä•-elim}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{contradiction}\AgdaSpace{}%
\AgdaBound{fv1}\AgdaSpace{}%
\AgdaBound{nfv1}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaBound{fv2}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{‚ä•-elim}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{contradiction}\AgdaSpace{}%
\AgdaBound{fv2}\AgdaSpace{}%
\AgdaBound{nfv2}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{‚Üì‚Üíùîº}%
\>[1851I]\AgdaSymbol{\{}\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œ≥}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œ≥'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{v'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ùîæŒ≥Œ≥'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{sub}\AgdaSymbol{\{}\AgdaArgument{v}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{v}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaBound{v'‚äëv}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{fv'}\<%
\\
\>[.][@{}l@{}]\<[1851I]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚Üì‚Üíùîº}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œ≥}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œ≥'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ùîæŒ≥Œ≥'}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{above-fun-‚äë}\AgdaSpace{}%
\AgdaBound{fv'}\AgdaSpace{}%
\AgdaBound{v'‚äëv}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}%
\>[1874I]\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{M‚áìc}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ùïçv}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[.][@{}l@{}]\<[1874I]%
\>[6]\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{M‚áìc}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{sub-ùïç}\AgdaSpace{}%
\AgdaBound{ùïçv}\AgdaSpace{}%
\AgdaBound{v'‚äëv}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\end{code}
\end{fence}

\begin{itemize}
\item
  Case \texttt{var}. Looking up \texttt{x} in
  \texttt{Œ≥\textquotesingle{}} yields some closure,
  \texttt{clos\ M\textquotesingle{}\ Œ¥}, and from
  \texttt{ùîæ\ Œ≥\ Œ≥\textquotesingle{}} we have
  \texttt{ùîº\ (Œ≥\ x)\ (clos\ M\textquotesingle{}\ Œ¥)}. With the premise
  \texttt{above-fun\ (Œ≥\ x)}, we obtain a closure \texttt{c} such that
  \texttt{Œ¥\ ‚ä¢\ M\textquotesingle{}\ ‚áì\ c} and \texttt{ùïç\ (Œ≥\ x)\ c}. To
  conclude \texttt{Œ≥\textquotesingle{}\ ‚ä¢\ x\ ‚áì\ c} via \texttt{‚áì-var},
  we need
  \texttt{Œ≥\textquotesingle{}\ x\ ‚â°\ clos\ M\textquotesingle{}\ Œ¥},
  which is obvious, but it requires some Agda shananigans via the
  \texttt{kth-x} lemma to get our hands on it.
\item
  Case \texttt{‚Ü¶-elim}. We have \texttt{Œ≥\ ‚ä¢\ L\ ¬∑\ M\ ‚Üì\ v}. The
  induction hypothesis for \texttt{Œ≥\ ‚ä¢\ L\ ‚Üì\ v‚ÇÅ\ ‚Ü¶\ v} gives us
  \texttt{Œ≥\textquotesingle{}\ ‚ä¢\ L\ ‚áì\ clos\ L\textquotesingle{}\ Œ¥}
  and \texttt{ùïç\ v\ (clos\ L\textquotesingle{}\ Œ¥)}. Of course,
  \texttt{L\textquotesingle{}\ ‚â°\ ∆õ\ N} for some \texttt{N}. By the
  induction hypothesis for \texttt{Œ≥\ ‚ä¢\ M\ ‚Üì\ v‚ÇÅ}, we have
  \texttt{ùîº\ v‚ÇÅ\ (clos\ M\ Œ≥\textquotesingle{})}. Together with the
  premise \texttt{above-fun\ v} and
  \texttt{ùïç\ v\ (clos\ L\textquotesingle{}\ Œ¥)}, we obtain a closure
  \texttt{c\textquotesingle{}} such that
  \texttt{Œ¥\ ‚ä¢\ N\ ‚áì\ c\textquotesingle{}} and
  \texttt{ùïç\ v\ c\textquotesingle{}}. We conclude that
  \texttt{Œ≥\textquotesingle{}\ ‚ä¢\ L\ ¬∑\ M\ ‚áì\ c\textquotesingle{}} by
  rule \texttt{‚áì-app}.
\item
  Case \texttt{‚Ü¶-intro}. We have \texttt{Œ≥\ ‚ä¢\ ∆õ\ N\ ‚Üì\ v\ ‚Ü¶\ w}. We
  immediately have
  \texttt{Œ≥\textquotesingle{}\ ‚ä¢\ ∆õ\ M\ ‚áì\ clos\ (∆õ\ M)\ Œ≥\textquotesingle{}}
  by rule \texttt{‚áì-lam}. But we also need to prove
  \texttt{ùïç\ (v\ ‚Ü¶\ w)\ (clos\ (∆õ\ N)\ Œ≥\textquotesingle{})}. Let
  \texttt{c} by an arbitrary closure such that \texttt{ùîº\ v\ c}. Suppose
  \texttt{v\textquotesingle{}} is greater than a function value. We need
  to show that
  \texttt{Œ≥\textquotesingle{}\ ,\ c\ ‚ä¢\ N\ ‚áì\ c\textquotesingle{}} and
  \texttt{ùïç\ v\textquotesingle{}\ c\textquotesingle{}} for some
  \texttt{c\textquotesingle{}}. We prove this by the induction
  hypothesis for \texttt{Œ≥\ ,\ v\ ‚ä¢\ N\ ‚Üì\ v\textquotesingle{}} but we
  must first show that
  \texttt{ùîæ\ (Œ≥\ ,\ v)\ (Œ≥\textquotesingle{}\ ,\ c)}. We prove that by
  the lemma \texttt{ùîæ-ext}, using facts
  \texttt{ùîæ\ Œ≥\ Œ≥\textquotesingle{}} and \texttt{ùîº\ v\ c}.
\item
  Case \texttt{‚ä•-intro}. We have the premise \texttt{above-fun\ ‚ä•}, but
  that's impossible.
\item
  Case \texttt{‚äî-intro}. We have \texttt{Œ≥\ ‚ä¢\ M\ ‚Üì\ (v‚ÇÅ\ ‚äî\ v‚ÇÇ)} and
  \texttt{above-fun\ (v‚ÇÅ\ ‚äî\ v‚ÇÇ)} and need to show
  \texttt{Œ≥\textquotesingle{}\ ‚ä¢\ M\ ‚Üì\ c} and
  \texttt{ùïç\ (v‚ÇÅ\ ‚äî\ v‚ÇÇ)\ c} for some \texttt{c}. Again, by
  \texttt{above-fun-‚äî}, at least one of \texttt{v‚ÇÅ} or \texttt{v‚ÇÇ} is
  greater than a function.

  \begin{itemize}
  \item
    Suppose both \texttt{v‚ÇÅ} and \texttt{v‚ÇÇ} are greater than a function
    value. By the induction hypotheses for \texttt{Œ≥\ ‚ä¢\ M\ ‚Üì\ v‚ÇÅ} and
    \texttt{Œ≥\ ‚ä¢\ M\ ‚Üì\ v‚ÇÇ} we have
    \texttt{Œ≥\textquotesingle{}\ ‚ä¢\ M\ ‚áì\ c‚ÇÅ}, \texttt{ùïç\ v‚ÇÅ\ c‚ÇÅ},
    \texttt{Œ≥\textquotesingle{}\ ‚ä¢\ M\ ‚áì\ c‚ÇÇ}, and \texttt{ùïç\ v‚ÇÇ\ c‚ÇÇ}
    for some \texttt{c‚ÇÅ} and \texttt{c‚ÇÇ}. Because \texttt{‚áì} is
    deterministic, we have \texttt{c‚ÇÇ\ ‚â°\ c‚ÇÅ}. Then by \texttt{ùïç‚äî-intro}
    we conclude that \texttt{ùïç\ (v‚ÇÅ\ ‚äî\ v‚ÇÇ)\ c‚ÇÅ}.
  \item
    Without loss of generality, suppose \texttt{v‚ÇÅ} is greater than a
    function value but \texttt{v‚ÇÇ} is not. By the induction hypotheses
    for \texttt{Œ≥\ ‚ä¢\ M\ ‚Üì\ v‚ÇÅ}, and using \texttt{ùïç‚ÜíWHNF}, we have
    \texttt{Œ≥\textquotesingle{}\ ‚ä¢\ M\ ‚áì\ clos\ (∆õ\ N)\ Œ≥‚ÇÅ} and
    \texttt{ùïç\ v‚ÇÅ\ (clos\ (∆õ\ N)\ Œ≥‚ÇÅ)}. Then because \texttt{v‚ÇÇ} is not
    greater than a function, we also have
    \texttt{ùïç\ v‚ÇÇ\ (clos\ (∆õ\ N)\ Œ≥‚ÇÅ)}. We conclude that
    \texttt{ùïç\ (v‚ÇÅ\ ‚äî\ v‚ÇÇ)\ (clos\ (∆õ\ N)\ Œ≥‚ÇÅ)}.
  \end{itemize}
\item
  Case \texttt{sub}. We have \texttt{Œ≥\ ‚ä¢\ M\ ‚Üì\ v},
  \texttt{v\textquotesingle{}\ ‚äë\ v}, and
  \texttt{above-fun\ v\textquotesingle{}}. We need to show that
  \texttt{Œ≥\textquotesingle{}\ ‚ä¢\ M\ ‚áì\ c} and
  \texttt{ùïç\ v\textquotesingle{}\ c} for some \texttt{c}. We have
  \texttt{above-fun\ v} by \texttt{above-fun-‚äë}, so the induction
  hypothesis for \texttt{Œ≥\ ‚ä¢\ M\ ‚Üì\ v} gives us a closure \texttt{c}
  such that \texttt{Œ≥\textquotesingle{}\ ‚ä¢\ M\ ‚áì\ c} and
  \texttt{ùïç\ v\ c}. We conclude that \texttt{ùïç\ v\textquotesingle{}\ c}
  by \texttt{sub-ùïç}.
\end{itemize}

\hypertarget{proof-of-denotational-adequacy}{%
\section{Proof of denotational
adequacy}\label{proof-of-denotational-adequacy}}

From the main lemma we can directly show that
\texttt{‚Ñ∞\ M\ ‚âÉ\ ‚Ñ∞\ (∆õ\ N)} implies that \texttt{M} big-steps to a
lambda, i.e., \texttt{‚àÖ\ ‚ä¢\ M\ ‚áì\ clos\ (∆õ\ N‚Ä≤)\ Œ≥}.

\begin{fence}
\begin{code}%
\>[0]\AgdaFunction{‚Üì‚Üí‚áì}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[1895I]\AgdaSymbol{‚àÄ\{}\AgdaBound{M}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSymbol{\}\{}\AgdaBound{N}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSymbol{\}}%
\>[35]\AgdaSymbol{‚Üí}%
\>[38]\AgdaFunction{‚Ñ∞}\AgdaSpace{}%
\AgdaBound{M}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaFunction{‚Ñ∞}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{)}\<%
\\
\>[1895I][@{}l@{\AgdaIndent{0}}]%
\>[9]\AgdaSymbol{‚Üí}%
\>[12]\AgdaFunction{Œ£[}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaFunction{‚àà}\AgdaSpace{}%
\AgdaDatatype{Context}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaFunction{Œ£[}\AgdaSpace{}%
\AgdaBound{N‚Ä≤}\AgdaSpace{}%
\AgdaFunction{‚àà}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaFunction{Œ£[}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSpace{}%
\AgdaFunction{‚àà}\AgdaSpace{}%
\AgdaFunction{ClosEnv}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaFunction{]}\<%
\\
%
\>[12]\AgdaFunction{‚àÖ'}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaBound{M}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚áì}}\AgdaSpace{}%
\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ≥}\<%
\\
\>[0]\AgdaFunction{‚Üì‚Üí‚áì}\AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}\{}\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{eq}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚Üì‚Üíùîº}\AgdaSpace{}%
\AgdaFunction{ùîæ-‚àÖ}%
\>[1940I]\AgdaSymbol{((}\AgdaField{proj‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{eq}\AgdaSpace{}%
\AgdaFunction{`‚àÖ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚ä•}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚Ü¶}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚ä•}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚Ü¶-intro}\AgdaSpace{}%
\AgdaInductiveConstructor{‚ä•-intro}\AgdaSymbol{))}\<%
\\
\>[.][@{}l@{}]\<[1940I]%
\>[17]\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚ä•}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚ä•}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{‚äë-refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[1956I]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{M‚Ä≤}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{M‚áìc}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Vc}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\\
\>[.][@{}l@{}]\<[1956I]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{ùïç‚ÜíWHNF}\AgdaSpace{}%
\AgdaBound{Vc}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[1971I]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∆õ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{N}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{N‚Ä≤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[.][@{}l@{}]\<[1971I]%
\>[4]\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{N‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{M‚áìc}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}%
\>[30]\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\end{code}
\end{fence}

The proof goes as follows. We derive \texttt{‚àÖ\ ‚ä¢\ ∆õ\ N\ ‚Üì\ ‚ä•\ ‚Ü¶\ ‚ä•} and
then \texttt{‚Ñ∞\ M\ ‚âÉ\ ‚Ñ∞\ (∆õ\ N)} gives us \texttt{‚àÖ\ ‚ä¢\ M\ ‚Üì\ ‚ä•\ ‚Ü¶\ ‚ä•}.
We conclude by applying the main lemma to obtain
\texttt{‚àÖ\ ‚ä¢\ M\ ‚áì\ clos\ (∆õ\ N‚Ä≤)\ Œ≥} for some \texttt{N‚Ä≤} and
\texttt{Œ≥}.

Now to prove the adequacy property. We apply the above lemma to obtain
\texttt{‚àÖ\ ‚ä¢\ M\ ‚áì\ clos\ (∆õ\ N‚Ä≤)\ Œ≥} and then apply \texttt{cbn‚Üíreduce}
to conclude.

\begin{fence}
\begin{code}%
\>[0]\AgdaFunction{adequacy}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{M}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSymbol{\}\{}\AgdaBound{N}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaSymbol{‚Üí}%
\>[6]\AgdaFunction{‚Ñ∞}\AgdaSpace{}%
\AgdaBound{M}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âÉ}}\AgdaSpace{}%
\AgdaFunction{‚Ñ∞}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaSymbol{‚Üí}%
\>[2005I]\AgdaFunction{Œ£[}\AgdaSpace{}%
\AgdaBound{N‚Ä≤}\AgdaSpace{}%
\AgdaFunction{‚àà}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{]}\<%
\\
\>[.][@{}l@{}]\<[2005I]%
\>[5]\AgdaSymbol{(}\AgdaBound{M}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚Äî‚Ü†}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N‚Ä≤}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{adequacy}\AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}\{}\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{eq}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚Üì‚Üí‚áì}\AgdaSpace{}%
\AgdaBound{eq}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[2020I]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{N‚Ä≤}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}\AgdaSpace{}%
\AgdaBound{Œ≥}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{M‚áì}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[.][@{}l@{}]\<[2020I]%
\>[4]\AgdaFunction{cbn‚Üíreduce}\AgdaSpace{}%
\AgdaBound{M‚áì}\<%
\end{code}
\end{fence}

\hypertarget{call-by-name-is-equivalent-to-beta-reduction}{%
\section{Call-by-name is equivalent to beta
reduction}\label{call-by-name-is-equivalent-to-beta-reduction}}

As promised, we return to the question of whether call-by-name
evaluation is equivalent to beta reduction. In chapter
\protect\hyperlink{BigStep}{BigStep} we established the forward
direction: that if call-by-name produces a result, then the program beta
reduces to a lambda abstraction (\texttt{cbn‚Üíreduce}). We now prove the
backward direction of the if-and-only-if, leveraging our results about
the denotational semantics.

\begin{fence}
\begin{code}%
\>[0]\AgdaFunction{reduce‚Üícbn}%
\>[2036I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{M}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{N}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[2036I]%
\>[11]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{M}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚Äî‚Ü†}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N}\<%
\\
%
\>[11]\AgdaSymbol{‚Üí}%
\>[2054I]\AgdaFunction{Œ£[}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaFunction{‚àà}\AgdaSpace{}%
\AgdaDatatype{Context}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaFunction{Œ£[}\AgdaSpace{}%
\AgdaBound{N‚Ä≤}\AgdaSpace{}%
\AgdaFunction{‚àà}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaFunction{Œ£[}\AgdaSpace{}%
\AgdaBound{Œ¥}\AgdaSpace{}%
\AgdaFunction{‚àà}\AgdaSpace{}%
\AgdaFunction{ClosEnv}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaFunction{]}\<%
\\
\>[.][@{}l@{}]\<[2054I]%
\>[13]\AgdaFunction{‚àÖ'}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaBound{M}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚áì}}\AgdaSpace{}%
\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ¥}\<%
\\
\>[0]\AgdaFunction{reduce‚Üícbn}\AgdaSpace{}%
\AgdaBound{M‚Äî‚Ü†∆õN}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{‚Üì‚Üí‚áì}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{soundness}\AgdaSpace{}%
\AgdaBound{M‚Äî‚Ü†∆õN}\AgdaSymbol{)}\<%
\end{code}
\end{fence}

Suppose \texttt{M\ ‚Äî‚Ü†\ ∆õ\ N}. Soundness of the denotational semantics
gives us \texttt{‚Ñ∞\ M\ ‚âÉ\ ‚Ñ∞\ (∆õ\ N)}. Then by \texttt{‚Üì‚Üí‚áì} we conclude
that \texttt{‚àÖ\textquotesingle{}\ ‚ä¢\ M\ ‚áì\ clos\ (∆õ\ N‚Ä≤)\ Œ¥} for some
\texttt{N‚Ä≤} and \texttt{Œ¥}.

Putting the two directions of the if-and-only-if together, we establish
that call-by-name evaluation is equivalent to beta reduction in the
following sense.

\begin{fence}
\begin{code}%
\>[0]\AgdaFunction{cbn‚Üîreduce}%
\>[2086I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{M}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[2086I]%
\>[11]\AgdaSymbol{‚Üí}%
\>[2093I]\AgdaSymbol{(}\AgdaFunction{Œ£[}\AgdaSpace{}%
\AgdaBound{N}\AgdaSpace{}%
\AgdaFunction{‚àà}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{M}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚Äî‚Ü†}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{))}\<%
\\
\>[.][@{}l@{}]\<[2093I]%
\>[13]\AgdaOperator{\AgdaFunction{iff}}\<%
\\
%
\>[13]\AgdaSymbol{(}\AgdaFunction{Œ£[}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaFunction{‚àà}\AgdaSpace{}%
\AgdaDatatype{Context}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaFunction{Œ£[}\AgdaSpace{}%
\AgdaBound{N‚Ä≤}\AgdaSpace{}%
\AgdaFunction{‚àà}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚òÖ}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaFunction{Œ£[}\AgdaSpace{}%
\AgdaBound{Œ¥}\AgdaSpace{}%
\AgdaFunction{‚àà}\AgdaSpace{}%
\AgdaFunction{ClosEnv}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaFunction{]}\<%
\\
\>[13][@{}l@{\AgdaIndent{0}}]%
\>[15]\AgdaFunction{‚àÖ'}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢}}\AgdaSpace{}%
\AgdaBound{M}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚áì}}\AgdaSpace{}%
\AgdaInductiveConstructor{clos}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{∆õ}}\AgdaSpace{}%
\AgdaBound{N‚Ä≤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Œ¥}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{cbn‚Üîreduce}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü®}}%
\>[2135I]\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{reduce‚Üícbn}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj‚ÇÇ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\<%
\\
\>[.][@{}l@{}]\<[2135I]%
\>[19]\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{cbn‚Üíreduce}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj‚ÇÇ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{))))}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ü©}}\<%
\end{code}
\end{fence}

\hypertarget{unicode}{%
\section{Unicode}\label{unicode}}

This chapter uses the following unicode:

\begin{myDisplay}
ùîº  U+1D53C  MATHEMATICAL DOUBLE-STRUCK CAPITAL E (\bE)
ùîæ  U+1D53E  MATHEMATICAL DOUBLE-STRUCK CAPITAL G (\bG)
ùïç  U+1D53E  MATHEMATICAL DOUBLE-STRUCK CAPITAL V (\bV)
\end{myDisplay}

